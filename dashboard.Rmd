---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r set_up, include=FALSE}
library(flexdashboard)
library(dplyr)
library(tidyverse)
library(lubridate)
library(plotly)
```

```{r}
noaa = read.csv("nynoaadat.csv") %>%
  mutate(date = as.Date(date))

noaa_long_00_10 = noaa %>%
  mutate(date = as.Date(date)) %>%
  filter(year(date) >= 2000, year(date) <= 2010) %>%
  mutate(month_num = month(date, label = TRUE))%>%
  mutate(month_num = as.factor(month_num)) %>%
  mutate(year = year(date)) %>%
  mutate(tmax = tmax/10)

snow_djf = noaa_long_00_10 %>%
  mutate(month_numeric = month(date),                
    month_label= month(date, label = TRUE)) %>%
  group_by(month_numeric, month_label, year) %>%
  summarise(avg_snow= mean(snow, na.rm= TRUE),.groups = "drop") %>%
  arrange(month_numeric)
  
precipitation = noaa_long_00_10 %>%
  filter(!is.na(prcp)) %>%
  mutate(month_numeric = month(date),                
    month_label= month(date, label = TRUE)) %>%
  group_by(month_numeric, month_label) %>%
  summarise(avg_prcp= mean((prcp/10), na.rm= TRUE),.groups = "drop") %>%
  arrange(month_numeric)
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
int_box = noaa_long_00_10 %>%
  plot_ly(x = ~month_num, y = ~tmax, type = "box", color = ~month_num, 
    jitter = 0.3) %>%
  layout(xaxis = list(title = "Month"),
         yaxis = list(title = "Maximum Temperature (C)"),
         title = "Range of Maximum Temperature Internationally (2000-2010)")
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
snow_plot = snow_djf %>%
  plot_ly(x= ~month_numeric, y= ~avg_snow, type = "scatter", mode = "markers", text = ~month_label, color= ~year) %>%
  layout(xaxis = list(title = "Month"),
         yaxis = list(title = "Snowfall in mm"),
         title = "Average Monthly Snowfall Internationally (2000-2010)")
```

### Chart C

```{r}
precip_bar = precipitation %>%
  plot_ly(x= ~month_numeric, y= ~avg_prcp, type = "bar", text = ~month_label) %>%
  layout(xaxis = list(title = "Month"),
         yaxis = list(title = "Precipitation in mm"),
         title = "International Average Monthly Precipitation (2000-2010)")
```

```{r}
rmarkdown::render("dashboard.Rmd", output_format = "flexdashboard::flex_dashboard")
```
